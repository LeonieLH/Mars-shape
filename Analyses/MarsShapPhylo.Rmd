---
title: "Marsupial shape and phylogenetics"
author: "Leonie Lange-Hodgson"
date: "22 January 2019"
output: html_document
---


# load required libraries

```{r}

library(geomorph)
library(ape)
library(plyr)
library(abind)

```
#read in coordinates
```{r}
 filelist <- list.files(path= "./Data/raw/Coordinates/", pattern = "*.txt")
  names <- gsub (".txt", "", filelist) # extracts names of specimens from the file name
  filelist <- paste("./Data/raw/Coordinates/", filelist, sep="") # rename with path
  coords <- NULL # make empty object that will be filled with 3D array of coordinate data
  for (i in 1:length(filelist)){
    temp <- read.morphologika(filelist[i])
    k <- dim(temp)[1]
    coords <- rbind(coords, two.d.array(temp)) }
  Data <- arrayspecs(coords, k, 3)
  dimnames(rep.1)[[3]] <- names
  remove(i, filelist, names, k, coords, temp) # clean up environment

```

#GPA - superimposing a group of shapes (removing all the differences in size/scale, orientation and location between this group of species) so that the only differences in the coordinates of corresponding landmarks between species must be the result of differences in shape between those species
```{r}
GPA <- gpagen(Data)

```